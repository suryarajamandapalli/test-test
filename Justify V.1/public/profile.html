<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Complete Profile</title>

  <link rel="stylesheet" href="./css/style.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="center">
  <div class="auth-card">

    <h3 class="mb-3">Complete Your Profile</h3>

    <input id="name" class="form-control mb-3" placeholder="Full Name">

    <input id="age" type="number" class="form-control mb-3" placeholder="Age">

    <select id="gender" class="form-select mb-4">
      <option value="">Select Gender</option>
      <option>Male</option>
      <option>Female</option>
      <option>Other</option>
    </select>

    <button class="btn btn-dark w-100" onclick="saveProfile()">
      Continue
    </button>

  </div>
</div>

<script type="module">
  import { auth } from "./js/firebase.js";
  import { getFirestore, doc, setDoc } from
    "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  const db = getFirestore();

  window.saveProfile = async () => {
    const age = Number(document.getElementById("age").value);

    if (age < 18) {
      alert("You must be 18+ to use Justify");
      return;
    }

    await setDoc(doc(db, "users", auth.currentUser.uid), {
      name: document.getElementById("name").value,
      age,
      gender: document.getElementById("gender").value,
      profileCompleted: true,
      createdAt: new Date()
    });

    window.location.href = "./dashboard.html";
  };
</script>

</body>
</html>